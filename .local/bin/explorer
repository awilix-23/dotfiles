#!/bin/bash
# Purpose: Internet search without needing to switch workspace first
#
BOOKMARKS=~/.config/qutebrowser/bookmarks/urls
QUERY=$(cut -d " " -f 2 ${BOOKMARKS} | wmenu_wrapper -p "search")

bkmk_exists=$(grep ${QUERY} ${BOOKMARKS} | cut -d " " -f 1)
if [[ -n ${bkmk_exists} ]]; then
  qutebrowser --target tab ${bkmk_exists}
  exit 0
fi

BANG=$(echo ${QUERY} | cut -d " " -f 1)
QUERY=$(echo ${QUERY} | cut -s -d " " -f 2-)
case ${BANG} in
  ";aw"|":aw")
    ENGINE="https://wiki.archlinux.org/?search" ;;
  *) # no bang provided
    BANG+=" ${QUERY}"
    QUERY=${BANG}
    ENGINE="https://duckduckgo.com/?q" ;;
esac

qutebrowser --target tab "${ENGINE}=${QUERY}"
exit 0
